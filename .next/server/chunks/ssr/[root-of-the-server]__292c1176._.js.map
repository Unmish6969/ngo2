{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///home/anuj/Documents/ngo2/src/app/services/authService.ts"],"sourcesContent":["import { api } from './api';\n\nexport interface LoginCredentials {\n  username: string;\n  password: string;\n}\n\nexport interface AuthResponse {\n  access_token: string;\n  token_type: string;\n}\n\nexport interface User {\n  id: number;\n  username: string;\n  email: string;\n  first_name: string | null;\n  last_name: string | null;\n  is_active: boolean;\n  is_admin: boolean;\n  profile_image: string | null;\n}\n\nexport const authService = {\n  login: async (credentials: LoginCredentials) => {\n    // Create FormData for the login request (FastAPI expects form data for OAuth)\n    const formData = new FormData();\n    formData.append('username', credentials.username);\n    formData.append('password', credentials.password);\n    \n    // POST to the token endpoint\n    const response = await fetch('http://localhost:8000/token', {\n      method: 'POST',\n      body: formData,\n    });\n    \n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Login failed');\n    }\n    \n    const data = await response.json();\n    \n    // Store token in localStorage for API requests\n    localStorage.setItem('token', data.access_token);\n    \n    // Also store token in cookies for middleware\n    document.cookie = `token=${data.access_token}; path=/; max-age=${60 * 30}`; // 30 minutes\n    \n    return data;\n  },\n  \n  logout: () => {\n    localStorage.removeItem('token');\n    document.cookie = 'token=; path=/; max-age=0'; // Delete the cookie\n  },\n  \n  isAuthenticated: () => {\n    return !!localStorage.getItem('token');\n  },\n  \n  // A simple function to decode the JWT token payload\n  // This is not secure for sensitive operations but useful for basic info\n  getTokenPayload: () => {\n    const token = localStorage.getItem('token');\n    if (!token) return null;\n    \n    try {\n      const base64Url = token.split('.')[1];\n      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n      const jsonPayload = decodeURIComponent(\n        atob(base64)\n          .split('')\n          .map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\n          .join('')\n      );\n      \n      return JSON.parse(jsonPayload);\n    } catch (error) {\n      console.error('Error decoding token:', error);\n      return null;\n    }\n  }\n}; "],"names":[],"mappings":";;;AAuBO,MAAM,cAAc;IACzB,OAAO,OAAO;QACZ,8EAA8E;QAC9E,MAAM,WAAW,IAAI;QACrB,SAAS,MAAM,CAAC,YAAY,YAAY,QAAQ;QAChD,SAAS,MAAM,CAAC,YAAY,YAAY,QAAQ;QAEhD,6BAA6B;QAC7B,MAAM,WAAW,MAAM,MAAM,+BAA+B;YAC1D,QAAQ;YACR,MAAM;QACR;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,QAAQ,MAAM,SAAS,IAAI;YACjC,MAAM,IAAI,MAAM,MAAM,MAAM,IAAI;QAClC;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,+CAA+C;QAC/C,aAAa,OAAO,CAAC,SAAS,KAAK,YAAY;QAE/C,6CAA6C;QAC7C,SAAS,MAAM,GAAG,CAAC,MAAM,EAAE,KAAK,YAAY,CAAC,kBAAkB,EAAE,KAAK,IAAI,EAAE,aAAa;QAEzF,OAAO;IACT;IAEA,QAAQ;QACN,aAAa,UAAU,CAAC;QACxB,SAAS,MAAM,GAAG,6BAA6B,oBAAoB;IACrE;IAEA,iBAAiB;QACf,OAAO,CAAC,CAAC,aAAa,OAAO,CAAC;IAChC;IAEA,oDAAoD;IACpD,wEAAwE;IACxE,iBAAiB;QACf,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,CAAC,OAAO,OAAO;QAEnB,IAAI;YACF,MAAM,YAAY,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;YACrC,MAAM,SAAS,UAAU,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM;YAC1D,MAAM,cAAc,mBAClB,KAAK,QACF,KAAK,CAAC,IACN,GAAG,CAAC,CAAA,IAAK,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,GAAG,QAAQ,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,IAC5D,IAAI,CAAC;YAGV,OAAO,KAAK,KAAK,CAAC;QACpB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,yBAAyB;YACvC,OAAO;QACT;IACF;AACF","debugId":null}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///home/anuj/Documents/ngo2/src/app/control-layout.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter, usePathname } from 'next/navigation';\nimport { authService } from './services/authService';\nimport Link from 'next/link';\n\nexport default function ControlLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const router = useRouter();\n  const pathname = usePathname();\n\n  // Handle logout\n  const handleLogout = () => {\n    authService.logout();\n    router.push('/login');\n  };\n\n  useEffect(() => {\n    const checkAuthStatus = async () => {\n      try {\n        // Check if user is authenticated\n        if (!authService.isAuthenticated()) {\n          // Redirect to login with the current path as redirect parameter\n          router.push(`/login?redirect=${encodeURIComponent(pathname)}`);\n          return;\n        }\n\n        // If we have a token, assume user is authorized for control pages\n        setIsAuthenticated(true);\n      } catch (error) {\n        console.error('Error verifying authentication status:', error);\n        router.push('/login');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    checkAuthStatus();\n  }, [router, pathname]);\n\n  // Show loading state while checking authentication\n  if (isLoading) {\n    return (\n      <div className=\"control-loading\">\n        Verifying access...\n        <style jsx>{`\n          .control-loading {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            font-size: 1.2rem;\n            color: white;\n            background: linear-gradient(\n              to bottom,\n              rgb(13, 17, 23),\n              rgb(26, 26, 46)\n            );\n          }\n        `}</style>\n      </div>\n    );\n  }\n\n  // If not authenticated, don't render anything (redirect should happen)\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  // If authenticated, render the control pages\n  return (\n    <div className=\"control-layout\">\n      <header className=\"control-header\">\n        <nav className=\"control-nav\">\n          <Link \n            href=\"/media_control\" \n            className={pathname === '/media_control' ? 'nav-link active' : 'nav-link'}\n          >\n            Media Control\n          </Link>\n          <Link \n            href=\"/member_control\" \n            className={pathname === '/member_control' ? 'nav-link active' : 'nav-link'}\n          >\n            Member Control\n          </Link>\n          <Link \n            href=\"/event_control\" \n            className={pathname === '/event_control' ? 'nav-link active' : 'nav-link'}\n          >\n            Event Control\n          </Link>\n        </nav>\n        <button onClick={handleLogout} className=\"logout-button\">\n          Logout\n        </button>\n      </header>\n      \n      <main className=\"control-content\">\n        {children}\n      </main>\n      \n      <style jsx>{`\n        .control-layout {\n          min-height: 100vh;\n          display: flex;\n          flex-direction: column;\n        }\n        \n        .control-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 1rem 2rem;\n          background: rgba(15, 23, 42, 0.9);\n          border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n        }\n        \n        .control-nav {\n          display: flex;\n          gap: 1.5rem;\n        }\n        \n        .nav-link {\n          color: rgba(255, 255, 255, 0.7);\n          text-decoration: none;\n          font-weight: 500;\n          padding: 0.5rem 0;\n          border-bottom: 2px solid transparent;\n          transition: all 0.2s ease;\n        }\n        \n        .nav-link:hover {\n          color: white;\n        }\n        \n        .nav-link.active {\n          color: white;\n          border-bottom-color: #3b82f6;\n        }\n        \n        .logout-button {\n          background: rgba(255, 255, 255, 0.1);\n          color: white;\n          border: none;\n          padding: 0.5rem 1rem;\n          border-radius: 0.25rem;\n          cursor: pointer;\n          transition: background 0.2s ease;\n        }\n        \n        .logout-button:hover {\n          background: rgba(255, 255, 255, 0.2);\n        }\n        \n        .control-content {\n          flex: 1;\n          padding: 1rem;\n        }\n      `}</style>\n    </div>\n  );\n} "],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;;AAOe,SAAS,cAAc,EACpC,QAAQ,EAGT;IACC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD;IAE3B,gBAAgB;IAChB,MAAM,eAAe;QACnB,qIAAA,CAAA,cAAW,CAAC,MAAM;QAClB,OAAO,IAAI,CAAC;IACd;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,kBAAkB;YACtB,IAAI;gBACF,iCAAiC;gBACjC,IAAI,CAAC,qIAAA,CAAA,cAAW,CAAC,eAAe,IAAI;oBAClC,gEAAgE;oBAChE,OAAO,IAAI,CAAC,CAAC,gBAAgB,EAAE,mBAAmB,WAAW;oBAC7D;gBACF;gBAEA,kEAAkE;gBAClE,mBAAmB;YACrB,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,0CAA0C;gBACxD,OAAO,IAAI,CAAC;YACd,SAAU;gBACR,aAAa;YACf;QACF;QAEA;IACF,GAAG;QAAC;QAAQ;KAAS;IAErB,mDAAmD;IACnD,IAAI,WAAW;QACb,qBACE,8OAAC;sDAAc;;gBAAkB;;;;;;;;;;;IAmBrC;IAEA,uEAAuE;IACvE,IAAI,CAAC,iBAAiB;QACpB,OAAO;IACT;IAEA,6CAA6C;IAC7C,qBACE,8OAAC;kDAAc;;0BACb,8OAAC;0DAAiB;;kCAChB,8OAAC;kEAAc;;0CACb,8OAAC,4JAAA,CAAA,UAAI;gCACH,MAAK;gCACL,WAAW,aAAa,mBAAmB,oBAAoB;0CAChE;;;;;;0CAGD,8OAAC,4JAAA,CAAA,UAAI;gCACH,MAAK;gCACL,WAAW,aAAa,oBAAoB,oBAAoB;0CACjE;;;;;;0CAGD,8OAAC,4JAAA,CAAA,UAAI;gCACH,MAAK;gCACL,WAAW,aAAa,mBAAmB,oBAAoB;0CAChE;;;;;;;;;;;;kCAIH,8OAAC;wBAAO,SAAS;kEAAwB;kCAAgB;;;;;;;;;;;;0BAK3D,8OAAC;0DAAe;0BACb;;;;;;;;;;;;;;;;AA+DT","debugId":null}}]
}